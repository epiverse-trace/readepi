<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Package design vignette for {readepi} • readepi</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Package design vignette for {readepi}">
<meta name="robots" content="noindex">
<!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-XZ471458FQ"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-XZ471458FQ');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">
    <a href="https://epiverse-trace.github.io/" class="external-link"><img src="https://epiverse-trace.github.io/blueprints/logo_white.svg" id="logo" alt="Epiverse-TRACE"></a>
    <a class="navbar-brand me-2" href="../index.html">readepi</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.0.2.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/readepi.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/design_principle.html">Package design vignette for {readepi}</a></li>
    <li><a class="dropdown-item" href="../articles/install_drivers.html">install_drivers</a></li>
    <li><a class="dropdown-item" href="../articles/query_parameters.html">query_parameters</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/epiverse-trace/readepi/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<link href="design_principle_files/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="design_principle_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><script src="design_principle_files/viz-1.8.2/viz.js"></script><link href="design_principle_files/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="design_principle_files/grViz-binding-1.0.11/grViz.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Package design vignette for {readepi}</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/epiverse-trace/readepi/blob/main/vignettes/design_principle.Rmd" class="external-link"><code>vignettes/design_principle.Rmd</code></a></small>
      <div class="d-none name"><code>design_principle.Rmd</code></div>
    </div>

    
    
<style type="text/css">
.section {
  opacity: 1;
}
</style>
<div class="section level2">
<h2 id="concept-and-motivation">Concept and motivation<a class="anchor" aria-label="anchor" href="#concept-and-motivation"></a>
</h2>
<div style="text-align: justify;">
<p>This document outlines the design decisions guiding the development
strategies of the <a href="https://epiverse-trace.github.io/readepi/">readepi</a> R package, the reasoning behind
them, as well as the possible pros and cons of each decision.</p>
<p>Importing data from various sources into the R environment is the
first step in the workflow of outbreak analysis. Health data are often
stored in individual files of different formats, in relational database
management systems (RDBMS), and more importantly, many health
organizations store their data in health information systems (HIS) that
are wrapped under hood of a specific Application Programming Interfaces
(APIs).</p>
<p>Many R packages have been developed over the years to read data
stored in a file or in a directory containing multiple files. We
recommend the <a href="http://gesistsa.github.io/rio/" class="external-link">{rio}</a> package
for importing data that are relatively small in size and the <a href="https://CRAN.R-project.org/package=data.table" class="external-link">{data.table}</a>
package for large files. For retrieving data from RDBMS, we recommend
the <a href="https://dbi.r-dbi.org/" class="external-link">{DBI}</a> package.</p>
<p>There are several R packages for reading data from HIS such as
{fingertipsR}, {REDCapR}, {godataR}, and {globaldothealth}, which are
used to fetch data from <a href="https://fingertips.phe.org.uk/" class="external-link">Fingertips</a>, <a href="https://projectredcap.org/software/" class="external-link">REDCap</a>, <a href="https://www.who.int/tools/godata" class="external-link">Go.Data</a>, and <a href="https://global.health/" class="external-link">Global.Health</a> respectively. However,
these packages are usually designed to read from specific HIS and can’t
be used to query others. This increases the dependency on many other
packages and introduces the challenge of having a unified framework for
importing data from multiple HIS. As such, we propose
<a href="https://epiverse-trace.github.io/readepi/">readepi</a>, a centralized tool that will provide users with
the capability of importing data from various HIS and RDBMS.</p>
<p><a href="https://epiverse-trace.github.io/readepi/">readepi</a> aims at importing data from several potential
sources in the same way. The data sources include distributed health
information systems and public databases as shown in the figure
below.</p>
</div>
<div class="float">
<img src="../reference/figures/roadmap_readepi.drawio.svg" alt="readepi roadmap"><div class="figcaption">readepi roadmap</div>
</div>
</div>
<div class="section level2">
<h2 id="scope">Scope<a class="anchor" aria-label="anchor" href="#scope"></a>
</h2>
<div style="text-align: justify;">
<p>The <a href="https://epiverse-trace.github.io/readepi/">readepi</a> package is designed to import data from
two common sources of institutional health-related data: HIS wrapped
with specific APIs and RDBMS that run on specific servers.</p>
<p>To import data from these sources, users must have read access and
provide the relevant query parameters to fetch the target data. The
current version of <a href="https://epiverse-trace.github.io/readepi/">readepi</a> supports importing data from:
- <strong>HISs</strong>: <a href="https://dhis2.org/" class="external-link">DHIS2</a> and <a href="https://sormas.org/" class="external-link">SORMAS</a>,</p>
<ul>
<li>
<strong>RDBMS</strong>: MS SQL, SQLite, MySQL, and PostgreSQL.</li>
</ul>
<p>In next releases, we plan to include features for reading data from
additional HISs like GoData, Globaldothealth, and ODK, as well as RDBMS
such as MS Access.</p>
</div>
<div class="float">
<img src="../reference/figures/readepi_design_diagram_v-0.1.0.drawio.svg" alt="Diagram of current functions available in {readepi}"><div class="figcaption">Diagram of current functions available in
{readepi}</div>
</div>
</div>
<div class="section level2">
<h2 id="output">Output<a class="anchor" aria-label="anchor" href="#output"></a>
</h2>
<div style="text-align: justify;">
<p>The main functions of the {readepi} package return a
<code>data frame</code> object that contains the data fetched from the
target source with the specified request parameters. The
<code><a href="../reference/login.html">login()</a></code> function returns a connection object that is used
in the subsequent queries.</p>
</div>
</div>
<div class="section level2">
<h2 id="design-decisions">Design decisions<a class="anchor" aria-label="anchor" href="#design-decisions"></a>
</h2>
<div style="text-align: justify;">
<p>The aim of {readepi} is to simplify and standardize the process of
fetching data from APIs and servers. We strive to make this easy for
users by limiting the number of required arguments to access and
retrieve the data of interest from the target source. As such, the
package is structured around few main functions:
<code><a href="../reference/read_dhis2.html">read_dhis2()</a></code>, <code><a href="../reference/read_sormas.html">read_sormas()</a></code>, and
<code><a href="../reference/read_rdbms.html">read_rdbms()</a></code>; and one auxiliary functions
(<code><a href="../reference/login.html">login()</a></code>).</p>
<div class="section level3">
<h3 id="authentication">Authentication<a class="anchor" aria-label="anchor" href="#authentication"></a>
</h3>
<p>The <code><a href="../reference/login.html">login()</a></code> function is used to establish connection
with the data source. It verifies the user’s identity and determines if
they are authorized to access the requested database or API.
Establishing this connection is crucial for ensuring successful data
import. However, the basic authentication does not work for SORMAS. To
maintain the design of the package across all HIS, the login function
returns a <list> object when importing data from SORMAS.</list></p>
<p>Once authentication credentials are provided, they are securely
stored within the connection object. This prevents the need to re-supply
them for subsequent requests in other functions. The Figure below lists
the arguments needed to call the <code><a href="../reference/login.html">login()</a></code> function.</p>
</div>
</div>
<div class="grViz html-widget html-fill-item" id="htmlwidget-ac96cb3ee4656e2e9ec3" style="width:768px;height:474.660074165637px;"></div>
<script type="application/json" data-for="htmlwidget-ac96cb3ee4656e2e9ec3">{"x":{"diagram":"digraph{\n \n      graph[rankdir = LR]\n  \n      node[shape = rectangle, style = filled, fontname = Courier,\n      align = center]\n  \n      subgraph cluster_0 {\n        graph[shape = rectangle]\n        style = rounded\n        bgcolor = LightBlue\n    \n        label = \"Arguments for login() function\"\n        node[shape = rectangle, fillcolor = LemonChiffon, margin = 0.25]\n        A[label = \"type: the source name\"]\n        B[label = \"from: the URL, or IP address, or hostname\"]\n        C[label = \"user_name: the user name\"]\n        D[label = \"password: the password or API token or key\"]\n        E[label = \"db_name: the database name (RDBMS only)\"]\n        F[label = \"port: the port id (RDBMS only)\"]\n        G[label = \"driver_name: the driver name (RDBMS only)\"]\n      }\n      \n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script><div style="text-align: justify;">
<p>The <code>type</code> argument refers to the name of the data source
of interest. The current version of the package covers the following
types:</p>
<pre><code>i) RDBMS: “ms sql”, “mysql”, “postgresql”, “sqlite”
ii) APIs: “dhis2”, “sormas”</code></pre>
</div>
<div class="section level3">
<h3 id="data-import">Data import<a class="anchor" aria-label="anchor" href="#data-import"></a>
</h3>
<p>You can use one of the functions below depending on the data
source.</p>
<ul>
<li>
<code><a href="../reference/read_rdbms.html">read_rdbms()</a></code>: for importing data from RDBMS. It takes
the following arguments:
<ul>
<li>
<strong>login</strong>: A <code>Pool</code> object obtained from the
<code><a href="../reference/login.html">login()</a></code> function</li>
<li>
<strong>query</strong>: A string with an SQL query or a list of
parameters. When the query parameters are provided as a list, they will
be used to form the appropriate SQL query internally. The resulting SQL
query will then be executed by the <code><a href="../reference/read_rdbms.html">read_rdbms()</a></code>.</li>
</ul>
</li>
<li>
<code><a href="../reference/read_dhis2.html">read_dhis2()</a></code>: for importing data from DHIS2. This
function expect the following arguments:
<ul>
<li>
<strong>login</strong>: A <code>httr2_response</code> object
returned by the <code><a href="../reference/login.html">login()</a></code> function</li>
<li>
<strong>org_unit</strong>: A character with the organisation unit ID
or name</li>
<li>
<strong>program</strong>: A character with the program ID or
name</li>
</ul>
</li>
<li>
<code><a href="../reference/read_sormas.html">read_sormas()</a></code>: for importing data from SORMAS. It takes
the following arguments:
<ul>
<li>
<strong>login</strong>: A <code>list</code> object returned by the
<code><a href="../reference/login.html">login()</a></code>
</li>
<li>
<strong>disease</strong>: A character vector with the names of the
diseases of interest. Users can get the list of all diseases which data
is available on their SORMAS system using the
<code><a href="../reference/sormas_get_diseases.html">sormas_get_diseases()</a></code> function.</li>
<li>
<strong>since</strong>: A Date value in ISO8601 format
(YYYY-mm-dd).</li>
</ul>
</li>
</ul>
<div style="text-align: justify;">
<p>Note that, when reading from RDBMS, the <code>query</code> argument
could be an <u>SQL query</u> or a <u>list with a vector of table names,
fields and rows to subset on</u>. For HIS, we strongly recommend reading
the vignette on the <a href="./query_parameters.Rmd">query_parameters</a> for more details
about the request parameters that are supported in the current version
of the package.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="dependencies">Dependencies<a class="anchor" aria-label="anchor" href="#dependencies"></a>
</h2>
<ul>
<li>The main and internal functions of the package rely primarily on
three packages:
<ul>
<li>
<a href="https://CRAN.R-project.org/package=httr2" class="external-link">{httr2}</a> or <a href="https://CRAN.R-project.org/package=data.table" class="external-link">{data.table}</a>:
These are used to construct and execute API requests.</li>
<li>
<a href="https://CRAN.R-project.org/package=dplyr" class="external-link">{dplyr}</a>:
Utilized for its data manipulation capabilities.</li>
</ul>
</li>
<li>The <code><a href="../reference/read_rdbms.html">read_rdbms()</a></code> function depends on the following
packages:
<ul>
<li>
<a href="https://CRAN.R-project.org/package=DBI" class="external-link">{DBI}</a>: Used for
database connectivity and querying.</li>
<li>
<a href="https://CRAN.R-project.org/package=pool" class="external-link">{pool}</a>:
Provides functionality for managing multiple database connections.</li>
<li>
<a href="https://CRAN.R-project.org/package=odbc" class="external-link">{odbc}</a>:
Supplies drivers required for accessing various DBMS.</li>
<li>
<a href="https://CRAN.R-project.org/package=RMySQL" class="external-link">{RMySQL}</a>:
Specifically used for MySQL database connectivity.</li>
</ul>
</li>
</ul>
<p>These functions also require system dependencies for OS-X and Linux
systems, detailed in the <a href="./install_drivers.Rmd">install drivers
vignette</a> vignette.</p>
<p>Additionally, the development of the package necessitates the
inclusion of other required packages: - <a href="https://CRAN.R-project.org/package=checkmate" class="external-link">{checkmate}</a> - <a href="https://CRAN.R-project.org/package=httptest2" class="external-link">{httptest2}</a> - <a href="https://CRAN.R-project.org/package=bookdown" class="external-link">{bookdown}</a> - <a href="https://CRAN.R-project.org/package=rmarkdown" class="external-link">{rmarkdown}</a> - <a href="https://CRAN.R-project.org/package=testthat" class="external-link">{testthat}</a> (&gt;=
3.0.0) - <a href="https://CRAN.R-project.org/package=knitr" class="external-link">{knitr}</a>
- <a href="https://CRAN.R-project.org/package=cli" class="external-link">{cli}</a> - <a href="https://CRAN.R-project.org/package=DiagrammeR" class="external-link">{DiagrammeR}</a> -
<a href="https://CRAN.R-project.org/package=cyclocomp" class="external-link">{cyclocomp}</a></p>
</div>
<div class="section level2">
<h2 id="contribute">Contribute<a class="anchor" aria-label="anchor" href="#contribute"></a>
</h2>
<p>There are no special requirements to contributing to {readepi},
please follow the <a href="https://github.com/epiverse-trace/.github/blob/main/CONTRIBUTING.md" class="external-link">package
contributing guide</a>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Karim Mané, Bubacarr Bah, data.org.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3. Theme provided by <a href="https://github.com/epiverse-trace/epiversetheme" class="external-link">epiversetheme</a> 0.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
